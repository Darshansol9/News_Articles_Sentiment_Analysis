(CNN) North Carolina's controversial bathroom law survived largely unscathed after last-minute wrangling at the close of the state legislative session.Late Friday, the General Assembly passed a slightly tweaked version of House Bill 2 , repealing only a workplace lawsuit provision, according state Rep. Chris Sgro, a Democrat who opposes the measure.The law was modified to restore workers' rights to use state law to sue over employment discrimination. It now goes to the desk of Gov. Pat McCrory, who had requested the change.Still, most of the provisions that outraged gay rights advocates, entertainers and business leaders remained in the bill -- such as the requirement that in government facilities, people use the bathroom that corresponds to their gender at birth."I am woefully embarrassed that this is the result of two and a half months of conversation about the most disastrous piece of legislation in the state's history," Sgro said of the modifications, according to CNN affiliate WRAL.The revision was a far cry from what LGBT groups and other critics demanded: a full repeal of the law."Legislators shamefully walked away from their job ... without fixing the deeply harmful and outrageous mess they created with HB2," JoDee Winterhof with the Human Rights Campaign said in a statement."Lawmakers may have run out the clock on this short session, but they won't be able to run away from North Carolina's voters in November."With Charlotte set to host the 2017 NBA All-Star Game in February, the league and Charlotte Hornets owner Michael Jordan had been in talks with lawmakers about modifying the law.JUST WATCHED Arrests follow HB2 protests at NC statehouse Replay More Videos ... MUST WATCH Arrests follow HB2 protests at NC statehouse 01:25Business and community leaders have urged the NBA to keep the game in the state, despite calls for a league boycott."We have been engaged in dialogue with numerous groups at the city and state levels, but we do not endorse the version of the bill that we understand is currently before the legislature," the NBA and Hornets said in a joint statement Thursday."We remain committed to our guiding principles of inclusion, mutual respect and equal protections for all. We continue to believe that constructive engagement with all sides is the right path forward. There has been no new decision made regarding the 2017 NBA All-Star Game."And it's unclear whether the revised measure will affect a pending lawsuit from the federal government over the law. The Justice Department lawsuit seeks declaratory relief and threatens to curtail federal funding to the North Carolina Department of Public Safety and the University of North Carolina.After the law's initial passage in March, musicians Bruce Springsteen, Demi Lovato, Nick Jonas, and the bands Pearl Jam and Boston canceled concerts in the state. Those cancellations have cost one major venue nearly $200,000 in ticket sales.