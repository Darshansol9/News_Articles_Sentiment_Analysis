online anonymity network tor high priority target national security agency the work attacking tor done nsa application vulnerability branch part system intelligence directorate sid the majority nsa employee work sid tasked collecting data communication system around world according top secret nsa presentation provided whistleblower edward snowden one successful technique nsa developed involves exploiting tor browser bundle collection program designed make easy people install use software the trick identified tor user internet executes attack firefox web browser nsa refers capability cne computer network exploitation first step process finding tor user to accomplish nsa relies vast capability monitor large part internet this done via agency partnership telecom firm program codenamed stormbrew fairview oakstar blarney nsa creates fingerprint detect http request tor network particular server these fingerprint loaded nsa database system like xkeyscore bespoke collection analysis tool nsa boast allows analyst see almost everything target internet using powerful data analysis tool codenames turbulence turmoil tumult nsa automatically sifts enormous amount internet traffic see looking tor connection last month brazilian tv news show fantastico showed screenshots nsa tool ability identify tor user monitoring internet traffic feature make tor powerful anonymity service fact tor user look alike internet make easy differentiate tor user web user on hand anonymity provided tor make impossible nsa know user whether user identifying individual tor user internet nsa us network secret internet server redirect user another set secret internet server codename foxacid infect user computer foxacid nsa system designed act matchmaker potential target attack developed nsa giving agency opportunity launch prepared attack system computer successfully attacked secretly call back foxacid server performs additional attack target computer ensure remains compromised long term continues provide eavesdropping information back nsa exploiting tor browser bundletor well designed robust anonymity tool successfully attacking difficult the nsa attack found individually target tor user exploiting vulnerability firefox browser tor application directly difficult tor user often turn vulnerable service like script flash using tor making difficult target service even nsa us series native firefox vulnerability attack user tor browser bundle according training presentation provided snowden egotisticalgiraffe exploit type confusion vulnerability e4x xml extension javascript this vulnerability exists firefox 11 0 16 0 2 well firefox 10 0 esr firefox version used recently tor browser bundle according another document vulnerability exploited egotisticalgiraffe inadvertently fixed mozilla removed e4x library vulnerability tor added firefox version tor browser bundle nsa confident would able find replacement firefox exploit worked version 17 0 esr quantum systemto trick target visiting foxacid server nsa relies secret partnership telecom company as part turmoil system nsa place secret server codenamed quantum key place internet backbone this placement ensures react faster website by exploiting speed difference server impersonate visited website target legitimate website respond thereby tricking target browser visit foxacid server academic literature called man middle attack known commercial academic security community more specifically example man side attack hard organization nsa reliably execute require attacker privileged position internet backbone exploit race condition nsa server legitimate website this top secret nsa diagram made public last month show quantum server impersonating google type attack nsa us fast quantum server execute packet injection attack surreptitiously redirects target foxacid server an article german magazine spiegel based additional top secret snowden document mention nsa developed attack technology name quantuminsert performs redirection attack another top secret tor presentation provided snowden mention quantumcookie force cooky onto target browser another quantum program degrade deny disrupt tor access technique used chinese government block citizen reading censored internet content hypothesized probable nsa attack technique foxacid systemaccording various top secret document provided snowden foxacid nsa codename nsa call exploit orchestrator internet enabled system capable attacking target computer variety different way it window 2003 computer configured custom software series perl script these server run nsa tailored access operation tao group tao another subgroup system intelligence directorate server public internet they normal looking domain name visited browser anywhere ownership domain traced back nsa however browser try visit foxacid server special url called foxacid tag server attempt infect browser computer effort take control the nsa trick browser using url using variety method including race condition attack mentioned frame injection attack foxacid tag designed look innocuous anyone see would suspicious an example one tag link removed given another top secret training presentation provided snowden currently registered domain name name example internal nsa training purpose training material state merely trying visit homepage real foxacid server result attack specialized url required this url would created tao specific nsa operation unique operation target this allows foxacid server know exactly target computer contact according snowden foxacid general cne system used many type attack tor attack described it designed modular flexibility allows tao swap replace exploit discovered run certain exploit certain type target valuable exploit saved important target low value exploit run technically sophisticated target chance detection high tao maintains library exploit based different vulnerability system different exploit authorized different target depending value target target technical sophistication value exploit consideration case tor user foxacid might use egotisticalgiraffe firefox browser according top secret operational management procedure manual provided snowden target successfully exploited infected one several payload two basic payload mentioned manual designed collect configuration location information target computer analyst determine infect computer decision made part technical sophistication target security software installed target computer called personal security product psp manual foxacid payload updated regularly tao for example manual refers version 8 2 1 1 one foxacid server also sophisticated capability avoid detection ensure successful infection target the operation manual state foxacid payload codename direscallop circumvent commercial product prevent malicious software making change system survive reboot process nsa also us phishing attack induce user click foxacid tag tao additionally us foxacid exploit callback general term computer infected automatic mean calling back nsa instruction possibly upload data target computer according top secret operational management procedure manual foxacid server configured receive callback codenamed frugalshot after callback foxacid server may run exploit ensure target computer remains compromised long term well install implant designed exfiltrate data 2008 nsa getting much foxacid callback data needed build special system manage